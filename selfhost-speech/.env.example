# ==========================
# Controledu Self-Host Speech
# Copy to .env and adjust.
# ==========================

# API server
SPEECH_API_HOST=0.0.0.0
SPEECH_API_PORT=8088
SPEECH_API_LOG_LEVEL=info
SPEECH_API_TOKEN=CHANGE_ME_LONG_RANDOM_TOKEN
SPEECH_API_IP_ALLOWLIST=
SPEECH_API_ALLOW_UNAUTH_HEALTH=true
SPEECH_API_ENABLE_DOCS=false
SPEECH_API_CORS_ORIGINS=https://teacher.kilocraft.org,https://student.kilocraft.org
SPEECH_API_MAX_UPLOAD_MB=64
SPEECH_API_TEMP_DIR=/tmp/controledu-speech

# TTS (Piper CLI)
SPEECH_TTS_ENABLED=true
SPEECH_TTS_MAX_CHARS=4000
PIPER_BIN_PATH=/runtime/piper/piper
PIPER_MODELS_DIR=/models/piper
# Example voice: ru_RU-ruslan-medium / en_US-amy-medium
PIPER_DEFAULT_VOICE=ru_RU-ruslan-medium
# Multispeaker models only; leave empty for single-speaker
PIPER_DEFAULT_SPEAKER_ID=
PIPER_TIMEOUT_SECONDS=30
PIPER_DEFAULT_LENGTH_SCALE=1.0
# Optional advanced tuning (leave empty to use Piper defaults)
PIPER_DEFAULT_NOISE_SCALE=
PIPER_DEFAULT_NOISE_W=
PIPER_DEFAULT_SENTENCE_SILENCE=

# STT (faster-whisper)
SPEECH_STT_ENABLED=true
# tiny / base / small / medium / large-v3 / distil-large-v3
WHISPER_MODEL=medium
WHISPER_DEVICE=cpu
# CPU usually: int8; GPU usually: float16
WHISPER_COMPUTE_TYPE=int8
WHISPER_MODELS_DIR=/models/whisper
WHISPER_CPU_THREADS=4
WHISPER_NUM_WORKERS=1
SPEECH_STT_DEFAULT_LANGUAGE=ru
SPEECH_STT_DEFAULT_TASK=transcribe
SPEECH_STT_DEFAULT_BEAM_SIZE=5
SPEECH_STT_DEFAULT_VAD_FILTER=true
SPEECH_STT_DEFAULT_WORD_TIMESTAMPS=false
SPEECH_STT_MAX_CONCURRENCY=1
SPEECH_STT_TIMEOUT_SECONDS=300
