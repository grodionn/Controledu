# Руководство по разметке

Это руководство для первой продакшен-ориентированной разметки датасета в Controledu.

## Стратегия разметки

Начинайте в две фазы:

1. Бинарная фаза (быстрый MVP)
- `ai_ui`
- `not_ai_ui`

2. Мультиклассовая фаза (когда соберете достаточно данных)
- `chatgpt_ui`
- `claude_ui`
- `gemini_ui`
- `copilot_ui`
- `perplexity_ui`
- `deepseek_ui`
- `poe_ui`
- оставить `not_ai_ui`

## Файл-источник разметки

`dataset/labels/classification.csv`

Колонки:

- `image_path`: относительный путь от корня датасета
- `label`: значение класса
- `source`: `collection_mode`, `manual` и т.д.
- `notes`: произвольные заметки для пограничных кейсов

Пример строки:

`raw/student-001/2026-02-20T12-31-10Z.jpg,ai_ui,collection_mode,виден интерфейс чата`

## Сложные негативы (обязательно)

Собирайте больше не-AI экранов, визуально похожих на AI:

- страницы поиска,
- страницы документации/wiki,
- форумы/мессенджеры,
- окна IDE/редакторов с сайдбарами, похожими на чат,
- страницы переводчиков/код-помощников, не входящих в список целевых запрещенных интерфейсов.

Сложные негативы сильно уменьшают ложные срабатывания.

## Правила качества разметки

1. Отбрасывайте нечитаемые/поврежденные/пустые изображения.
2. Размечайте по видимому UI, а не по предполагаемому намерению.
3. Держите определения классов строгими и стабильными.
4. Неуверенные примеры отмечайте в `notes` и пересматривайте позже.
5. Делайте second-pass review минимум для 10-20% выборки.

## Целевой баланс классов

- Не допускайте, чтобы `not_ai_ui` занимал 95%+.
- Стремитесь со временем собрать хотя бы несколько тысяч примеров для основных классов.
- Если некоторые классы редкие, используйте weighted loss и целевой сбор данных.

## Рекомендуемый процесс ревью

1. Быстро размечайте raw-захват в бинарном режиме.
2. Обучите базовую бинарную модель.
3. Найдите ложные срабатывания по eval-отчету.
4. Добавьте сложные негативы и переразметьте спорные примеры.
5. Переходите к multiclass, когда качество бинарной модели стабильно.

## Частые ошибки

- Смешивание бинарных и мультиклассовых меток в одном запуске обучения без маппинга.
- Разметка только по процессу браузера (`msedge`) без видимого подтверждения в UI.
- Отсутствие актуализации split-файлов после переразметки.
